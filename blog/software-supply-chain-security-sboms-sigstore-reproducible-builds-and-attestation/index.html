<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"><title>Software Supply Chain Security: SBOMs, Sigstore, Reproducible Builds, and Attestation · Leonardo Benicio</title><meta name=description content="An in-depth guide to securing the software supply chain: SBOMs, provenance, Sigstore, SLSA, reproducible builds, code signing, and operational best practices."><link rel=alternate type=application/rss+xml title=RSS href=https://lbenicio.dev/index.xml><link rel=canonical href=https://blog.lbenicio.dev/blog/software-supply-chain-security-sboms-sigstore-reproducible-builds-and-attestation/><link rel=preload href=/static/fonts/OpenSans-Regular.ttf as=font type=font/ttf crossorigin><link rel="stylesheet" href="/assets/css/fonts.min.40e2054b739ac45a0f9c940f4b44ec00c3b372356ebf61440a413c0337c5512e.css" crossorigin="anonymous" integrity="sha256-QOIFS3OaxFoPnJQPS0TsAMOzcjVuv2FECkE8AzfFUS4="><link rel="shortcut icon" href=/static/assets/favicon/favicon.ico><link rel=icon type=image/x-icon href=/static/assets/favicon/favicon.ico><link rel=icon href=/static/assets/favicon/favicon.svg type=image/svg+xml><link rel=icon href=/static/assets/favicon/favicon-32x32.png sizes=32x32 type=image/png><link rel=icon href=/static/assets/favicon/favicon-16x16.png sizes=16x16 type=image/png><link rel=apple-touch-icon href=/static/assets/favicon/apple-touch-icon.png><link rel=manifest href=/static/assets/favicon/site.webmanifest><link rel=mask-icon href=/static/assets/favicon/safari-pinned-tab.svg color=#209cee><meta name=msapplication-TileColor content="#209cee"><meta name=msapplication-config content="/static/assets/favicon/browserconfig.xml"><meta name=theme-color content="#d2e9f8"><meta property="og:title" content="Software Supply Chain Security: SBOMs, Sigstore, Reproducible Builds, and Attestation · Leonardo Benicio"><meta property="og:description" content="An in-depth guide to securing the software supply chain: SBOMs, provenance, Sigstore, SLSA, reproducible builds, code signing, and operational best practices."><meta property="og:url" content="https://blog.lbenicio.dev/blog/software-supply-chain-security-sboms-sigstore-reproducible-builds-and-attestation/"><meta property="og:type" content="article"><meta property="og:image" content="https://blog.lbenicio.dev/static/assets/images/blog/software-supply-chain-security-sboms-sigstore-reproducible-builds.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Software Supply Chain Security: SBOMs, Sigstore, Reproducible Builds, and Attestation · Leonardo Benicio"><meta name=twitter:description content="An in-depth guide to securing the software supply chain: SBOMs, provenance, Sigstore, SLSA, reproducible builds, code signing, and operational best practices."><meta name=twitter:site content="@lbenicio_"><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"About Leonardo Benicio","url":"https://blog.lbenicio.dev"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Person","name":"Leonardo Benicio","sameAs":["https://github.com/lbenicio","https://www.linkedin.com/in/leonardo-benicio","https://twitter.com/lbenicio_"],"url":"https://blog.lbenicio.dev"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://blog.lbenicio.dev/","name":"Home","position":1},{"@type":"ListItem","item":"https://blog.lbenicio.dev/","name":"Blog","position":2},{"@type":"ListItem","item":"https://blog.lbenicio.dev/blog/software-supply-chain-security-sboms-sigstore-reproducible-builds-and-attestation/","name":"Software Supply Chain Security Sboms Sigstore Reproducible Builds and Attestation","position":3}]}</script><link rel="stylesheet" href="/assets/css/main.min.1e8a566ac8bc3f0664d0db4ec8a015b07421c33fa11d336a6b914522a9cabf30.css" crossorigin="anonymous" integrity="sha256-6lhUOpwCHMSMROmggsVSp3AHKud6gBrIFGTzl3GV4BY="></head><body class="c6942b3 c03620d cf3bd2e"><script>(function(){try{document.addEventListener("gesturestart",function(e){e.preventDefault()}),document.addEventListener("touchstart",function(e){e.touches&&e.touches.length>1&&e.preventDefault()},{passive:!1});var e=0;document.addEventListener("touchend",function(t){var n=Date.now();n-e<=300&&t.preventDefault(),e=n},{passive:!1})}catch{}})()</script><a href=#content class="cba5854 c21e770 caffa6e cc5f604 cf2c31d cdd44dd c10dda9 c43876e c787e9b cddc2d2 cf55a7b c6dfb1e c9391e2">Skip to content</a>
<script>(function(){try{const e=localStorage.getItem("theme");e==="dark"&&document.documentElement.classList.add("dark");const t=document.querySelector('button[aria-label="Toggle theme"]');t&&t.setAttribute("aria-pressed",String(e==="dark"))}catch{}})();function toggleTheme(e){const s=document.documentElement,t=s.classList.toggle("dark");try{localStorage.setItem("theme",t?"dark":"light")}catch{}try{var n=e&&e.nodeType===1?e:document.querySelector('button[aria-label="Toggle theme"]');n&&n.setAttribute("aria-pressed",String(!!t))}catch{}}(function(){function e(){try{return document.documentElement.classList.contains("dark")?"dark":"light"}catch{return"light"}}function n(t){const n=document.getElementById("i98aca2"),s=document.getElementById("iad2af0"),o=document.getElementById("i975fb5");if(!n||!s||!o)return;try{n.style.transform="translateX(0)",n.style.transition||(n.style.transition="transform 200ms ease-out")}catch{}try{s.hidden=!1,s.style.display="block"}catch{}o.setAttribute("aria-expanded","true"),n.setAttribute("aria-hidden","false");try{document.body.classList.add("c150bbe")}catch{}const i=document.getElementById("i190984");i&&i.focus();try{window.umami&&typeof window.umami.track=="function"&&window.umami.track("mobile_menu_open",{page:location.pathname,theme:e(),source:t||"programmatic"})}catch{}}function t(t){const n=document.getElementById("i98aca2"),s=document.getElementById("iad2af0"),o=document.getElementById("i975fb5");if(!n||!s||!o)return;try{n.style.transform="translateX(100%)",n.style.transition||(n.style.transition="transform 200ms ease-out")}catch{}try{s.hidden=!0,s.style.display="none"}catch{}o.setAttribute("aria-expanded","false"),n.setAttribute("aria-hidden","true");try{document.body.classList.remove("c150bbe")}catch{}o.focus();try{window.umami&&typeof window.umami.track=="function"&&window.umami.track("mobile_menu_close",{page:location.pathname,theme:e(),source:t||"programmatic"})}catch{}}function s(e){e.key==="Escape"&&t("escape")}window.__openMobileMenu=n,window.__closeMobileMenu=t;try{window.addEventListener("keydown",s,!0)}catch{}})()</script><header class="cd019ba c98dfae cdd44dd cfdda01 c9ee25d ce2dc7a cd72dd7 cc0dc37" role=banner><div class="cfdda01 c6942b3 ccf47f4 c7c11d8"><a href=/ class="c87e2b0 c6942b3 c7c11d8 c1838fa cb594e4" aria-label=Home><img src=/static/assets/favicon/favicon.svg alt=Logo width=32 height=32 class="c3de71a c4d5191">
<span class="cf8f011 c4d1253 cbd72bc cd7e69e">Leonardo Benicio</span></a><div class="c6942b3 c85cbd4 c7c11d8 ca798da c1838fa c7a0580"><nav class="cc1689c cd9b445 c75065d c04bab1" aria-label=Main><a href=/ class="c4d1253 c9e4539 cbbda39 c01f421 c19ee42 c3ecea6">Home</a>
<a href=https://lbenicio.dev/about target=_blank rel="noopener noreferrer" class="c4d1253 c9e4539 cbbda39 c01f421 c19ee42 c3ecea6">About</a>
<a href=https://lbenicio.dev/timeline target=_blank rel="noopener noreferrer" class="c4d1253 c9e4539 cbbda39 c01f421 c19ee42 c3ecea6">Timeline</a>
<a href=https://lbenicio.dev/reading target=_blank rel="noopener noreferrer" class="c4d1253 c9e4539 cbbda39 c01f421 c19ee42 c3ecea6">Reading</a>
<a href=https://publications.lbenicio.dev target=_blank rel="noopener noreferrer" class="c4d1253 c9e4539 cbbda39 c01f421 c19ee42 c3ecea6">Publications</a>
<a href=https://lbenicio.dev/contact target=_blank rel="noopener noreferrer" class="c4d1253 c9e4539 cbbda39 c01f421 c19ee42 c3ecea6">Contact</a></nav><button id="i1d73d4" type=button class="c1d6c20 c81ac7c c6a899b c7c11d8 c1d0018 c10dda9 c8e184d c514027 c88daee c7a66a6 c097fa1 cfc01c7 c286dd7 c2bd687 cfdce1d cfef18f" onclick=toggleTheme(this) aria-label="Toggle theme" aria-pressed=false title="Toggle theme">
<svg class="cb26e41 c50ceea cb69a5c c4f45c8 c8c2c40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg class="cb26e41 c8fca2b cb69a5c c4f45c8 cc1689c c9c27ff" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="4"/><path d="M12 2v4"/><path d="M12 18v4"/><path d="M2 12h4"/><path d="M18 12h4"/><path d="M4.93 4.93l2.83 2.83"/><path d="M16.24 16.24l2.83 2.83"/><path d="M6.34 17.66l2.83-2.83"/><path d="M14.83 9.17l2.83-2.83"/></svg>
<span class="cba5854">Toggle theme</span></button><div class="c658bcf c097fa1"><button id="i975fb5" type=button class="c1d6c20 c81ac7c c6a899b c7c11d8 c1d0018 c10dda9 c8e184d c514027 c88daee c7a66a6 cfc01c7 c286dd7 c2bd687 cfdce1d cfef18f" aria-label="Open menu" aria-controls="i98aca2" aria-expanded=false onclick='window.__openMobileMenu("button")' data-d38f920=mobile_menu_open_click>
<svg class="c20e4eb cb58471" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
<span class="cba5854">Open menu</span></button></div></div></div></header><div id="iad2af0" class="caffa6e ce4b5f4 c14639a" style=background-color:hsl(var(--background)) hidden onclick='window.__closeMobileMenu("overlay")' data-d38f920=mobile_menu_overlay_click></div><aside id="i98aca2" class="caffa6e c9efbc5 c437fa9 c49e97e c6c6936 c7cacca c7b34a4 c787e9b c88daee cad071a c6942b3 c03620d" role=dialog aria-modal=true aria-hidden=true aria-label="Mobile navigation" style="transform:translateX(100%);transition:transform 200ms ease-out;will-change:transform"><div class="c6942b3 c7c11d8 c82c52d c5df473 ccf47f4 c9ee25d"><a href=/ class="c6942b3 c7c11d8 c1838fa" aria-label=Home><img src=/static/assets/favicon/favicon.svg alt=Logo width=24 height=24 class="c20e4eb cb58471">
<span class="c62aaf0 c7c1b66 cbd72bc">Leonardo Benicio</span>
</a><button id="i190984" type=button class="c1d6c20 c81ac7c c6a899b c7c11d8 c1d0018 c10dda9 c514027 c286dd7 c2bd687 cfdce1d" aria-label="Close menu" onclick='window.__closeMobileMenu("button")' data-d38f920=mobile_menu_close_click>
<svg class="c16e528 c61f467" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
<span class="cba5854">Close</span></button></div><nav class="c85cbd4 ca0eaa4 c5df473 c6689b9"><ul class="cd69733"><li><a href=/ class="c3b5299 c10dda9 cddc2d2 cf55a7b c7c1b66 cbbda39 c3ecea6 c19ee42 c514027" onclick=window.__closeMobileMenu()>Home</a></li><li><a href=https://lbenicio.dev/about target=_blank rel="noopener noreferrer" class="c3b5299 c10dda9 cddc2d2 cf55a7b c7c1b66 cbbda39 c3ecea6 c19ee42 c514027" onclick=window.__closeMobileMenu()>About</a></li><li><a href=https://lbenicio.dev/timeline target=_blank rel="noopener noreferrer" class="c3b5299 c10dda9 cddc2d2 cf55a7b c7c1b66 cbbda39 c3ecea6 c19ee42 c514027" onclick=window.__closeMobileMenu()>Timeline</a></li><li><a href=https://lbenicio.dev/reading target=_blank rel="noopener noreferrer" class="c3b5299 c10dda9 cddc2d2 cf55a7b c7c1b66 cbbda39 c3ecea6 c19ee42 c514027" onclick=window.__closeMobileMenu()>Reading</a></li><li><a href=https://publications.lbenicio.dev target=_blank rel="noopener noreferrer" class="c3b5299 c10dda9 cddc2d2 cf55a7b c7c1b66 cbbda39 c3ecea6 c19ee42 c514027" onclick=window.__closeMobileMenu()>Publications</a></li><li><a href=https://lbenicio.dev/contact target=_blank rel="noopener noreferrer" class="c3b5299 c10dda9 cddc2d2 cf55a7b c7c1b66 cbbda39 c3ecea6 c19ee42 c514027" onclick=window.__closeMobileMenu()>Contact</a></li></ul></nav><div class="c60a4cc ccdf0e8 c277478 c13044e"><p>&copy; 2026 Leonardo Benicio</p></div></aside><div class="caffa6e c437fa9 ce9aced c97bba6 c15da2a c975cba" role=complementary aria-label="GitHub repository"><div class="c9d056d c252f85 ca22532 ca88a1a c876315"><div class="c6942b3 c7c11d8 c1d0018 cd1fd22 c6066e4 c43876e ce3d5b6 caa20d2 c3ecea6 c0cd2e2 cddc2d2 c3ed5c9 cd4074c c876315"><a href=https://github.com/lbenicio/aboutme target=_blank rel="noopener noreferrer" class="c6942b3 c7c11d8 cd1fd22 c71bae8 cfac1ac c19ee42 c25dc7c cb40739 cbbda39 cf55a7b" aria-label="View source on GitHub"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="cb26e41 c41bcd4 cf17690 cfa4e34 c78d562" aria-hidden="true"><path d="M15 22v-4a4.8 4.8.0 00-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35.0-3.5.0.0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35.0 3.5A5.403 5.403.0 004 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
<span class="cb5c327 cd7e69e">Fork me</span></a></div></div></div><main id="i7eccc0" class="cfdda01 c5df473 c0eecc8 c85cbd4" role=main aria-label=Content><nav class="cb545ce c8d8ae4 c277478" aria-label=Breadcrumb><ol class="c6942b3 c3adaf2 c7c11d8 cd365ee c3ecea6"><li><a href=/ class="c19ee42 c71bae8 cfac1ac">Home</a></li><li class="c6942b3 c7c11d8 cd365ee"><span class="cb82ddd">/</span><a href=/ class="c19ee42 c71bae8 cfac1ac">Blog</a></li><li class="c6942b3 c7c11d8 cd365ee"><span class="cb82ddd">/</span><span class="c88daee">Software Supply Chain Security Sboms Sigstore Reproducible Builds and Attestation</span></li></ol></nav><article class="c461ba0 c1c203f cfb6084 c995404 c6ca165"><nav class="cb545ce c8d8ae4 c277478" aria-label=Breadcrumb><ol class="c6942b3 c3adaf2 c7c11d8 cd365ee c3ecea6"><li><a href=/ class="c19ee42 c71bae8 cfac1ac">Home</a></li><li class="c6942b3 c7c11d8 cd365ee"><span class="cb82ddd">/</span><a href=/ class="c19ee42 c71bae8 cfac1ac">Blog</a></li><li class="c6942b3 c7c11d8 cd365ee"><span class="cb82ddd">/</span><span class="c88daee">Software Supply Chain Security Sboms Sigstore Reproducible Builds and Attestation</span></li></ol></nav><header class="c8aedc7"><h1 class="cf304bc c6fb0fe cf8f011 cc484e1">Software Supply Chain Security: SBOMs, Sigstore, Reproducible Builds, and Attestation</h1><div class="c277478 c3ecea6 c8fb24a">2022-04-19
· Leonardo Benicio</div><div class="c1a1a3f c8124f2"><img src=/static/assets/images/blog/software-supply-chain-security-sboms-sigstore-reproducible-builds.png alt class="cfdda01 c524300 c677556"></div><p class="lead c3ecea6">An in-depth guide to securing the software supply chain: SBOMs, provenance, Sigstore, SLSA, reproducible builds, code signing, and operational best practices.</p></header><div class="content"><p>The software supply chain is the set of processes, tools, and artifacts that transform source code into software that runs in production. Protecting that supply chain is critical: compromises at any step — compromised dependencies, corrupted CI/CD pipelines, or forged releases — can lead to large-scale incidents that affect thousands of downstream systems.</p><p>This post explains the modern toolbox for defending the software supply chain: Software Bill of Materials (SBOM) formats and generation, provenance and attestation concepts, Sigstore for transparent signature & provenance, reproducible builds, SLSA (Supply chain Levels for Software Artifacts), secure signing and key management, package ecosystem-specific hazards (npm, PyPI, crates.io), and operational practices for CI/CD and incident response.</p><h2 id="1-why-supply-chain-security-matters">1. Why supply chain security matters</h2><p>Software systems are composed of many moving parts: open-source packages, container images, build tools, third-party binaries, plugins, and deployment scripts. A single malicious or vulnerable dependency used in many projects can scale into widespread compromise.</p><p>Historic incidents underscore the problem:</p><ul><li>The SolarWinds compromise (2020) demonstrated how an attacker levering CI and release signing trust can distribute malicious updates widely.</li><li>The use of typosquatted packages in package ecosystems (npm/PyPI) exposes projects to supply-side injection by malicious actors.</li><li>Compromised CI credentials enabling an attacker to push signed binaries or new versions with backdoors.</li></ul><p>Supply chain security aims to reduce the blast radius of such attacks by increasing visibility (SBOMs), integrity guarantees (signatures and attestations), reproducibility (reproducible builds), and best-practice controls (CI isolation, least privilege, and attestation policy enforcement).</p><h2 id="2-sboms-what-they-are-and-why-they-help">2. SBOMs: what they are and why they help</h2><p>An SBOM (Software Bill of Materials) is a formal record describing the components and dependencies that make up a software artifact. SBOMs provide:</p><ul><li>Transparency: who depends on what, including transitive dependencies.</li><li>Auditability: help teams discover components with known vulnerabilities.</li><li>Compliance: evidence for licensing and provenance requirements.</li></ul><h3 id="21-common-sbom-formats">2.1 Common SBOM formats</h3><ul><li>SPDX: a widely adopted format with a detailed taxonomy for licenses, package relationships, and file-level evidence. SPDX supports machine-readable RDF/JSON and text summaries.</li><li>CycloneDX: designed specifically for software BOMs, with compact JSON/XML payloads and focus on security use-cases and vulnerability tooling.</li></ul><p>Choosing a format depends on toolchain compatibility and ecosystem expectations. CycloneDX has strong adoption in security tooling, while SPDX is widely used for licensing and compliance workflows.</p><h3 id="22-generating-sboms">2.2 Generating SBOMs</h3><p>SBOMs can be generated at multiple points:</p><ul><li>At build time: capture exact dependency graph used by the build system (e.g., Maven, npm, Cargo). Tools like <code>cyclonedx</code> or <code>syft</code> can analyze lockfiles and produced artifacts.</li><li>From artifacts: inspect container images or binary packages to extract metadata and embedded package information.</li></ul><p>Best practice: generate SBOMs as part of CI/CD, attach them to the artifact in the registry, and sign the SBOM alongside the artifact to bind the two.</p><h2 id="3-provenance-and-attestations">3. Provenance and attestations</h2><p>SBOMs list components, but who produced an artifact and how it was built is equally important. Provenance records describe the origin of an artifact and can include:</p><ul><li>The commit SHA of the source repository used to build the artifact.</li><li>The exact build command and environment (OS, toolchain versions).</li><li>Links to the SBOM and test results.</li></ul><p>Attestations are signed statements (structured metadata) asserting properties about artifacts, e.g., &ldquo;artifact X was built by CI job Y at time T&rdquo;.</p><h3 id="31-in-toto-and-provenance-formats">3.1 In-toto and provenance formats</h3><ul><li>In-toto defines a framework for securing the integrity of the software supply chain by modeling steps (called &ldquo;links&rdquo;) and cryptographic signing of step metadata. Links capture who ran what, on which materials, and produce output materials.</li><li>The newer provenance formats, such as the GitHub Actions <code>provenance</code> and the in-progress standardized <code>provenance</code> fields in OCI image manifests, aim to provide interoperable provenance metadata.</li></ul><h2 id="4-sigstore-and-transparent-signing">4. Sigstore and transparent signing</h2><p>Sigstore is an open-source project that provides transparent, verifiable signing for software artifacts, emphasizing developer convenience and strong cryptographic assurance.</p><p>Key components:</p><ul><li>Fulcio: a short-lived certificate authority that issues ephemeral certificates to signers after authenticating them through an OpenID Connect (OIDC) flow.</li><li>Rekor: a transparency log (append-only) that records signatures and certificates, enabling public audit.</li><li>Cosign: a CLI tool to sign container images and other artifacts using keys or OIDC-based ephemeral certs.</li></ul><p>Sigstore&rsquo;s model reduces long-lived key management burden and provides public transparency: signatures are logged, making it possible to detect suspicious signatures or key misuse.</p><h3 id="41-example-signing-an-image-with-cosign">4.1 Example: signing an image with cosign</h3><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-sh" data-lang=sh><span style=display:flex><span>cosign sign --key cosign.key example.com/org/image:tag
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># or use OIDC (no key needed)</span>
</span></span><span style=display:flex><span>cosign sign --oidc example.com/org/image:tag
</span></span></code></pre></div><p>Cosign can also generate and sign a provenance attestation (in-tree or using <code>notation</code>), and Rekor stores the signature for later audit.</p><h2 id="5-reproducible-builds-reducing-trust-in-builders">5. Reproducible builds: reducing trust in builders</h2><p>A reproducible build ensures that given the same source and dependencies, the build process produces bit-for-bit identical artifacts. Reproducible builds provide strong guarantees:</p><ul><li>They allow independent parties to rebuild and verify that an artifact matches what was released, detecting injected binaries.</li><li>They reduce reliance on trusting a single build environment.</li></ul><h3 id="51-challenges-to-reproducibility">5.1 Challenges to reproducibility</h3><ul><li>Non-deterministic inputs: timestamps, build paths, locale differences, and randomized data can cause variations.</li><li>Dependency immutability: external mirrors or registries changing artifacts can alter build outputs.</li></ul><p>Mitigations:</p><ul><li>Fix timestamps or use deterministic timestamps (SOURCE_DATE_EPOCH).</li><li>Normalize build environments with containers or Nix-style declarative environments.</li><li>Vendor or lock dependencies with cryptographic checksums (lockfiles, shrinkwrap).</li></ul><h2 id="6-slsa-a-provenance--policy-framework">6. SLSA: a provenance & policy framework</h2><p>SLSA (Supply chain Levels for Software Artifacts) is a framework defining increasing levels of assurance (SLSA 1 through 4) for build provenance and artifact integrity. Each level specifies requirements such as:</p><ul><li>SLSA 1: basic provenance (e.g., build record exists).</li><li>SLSA 2: tamper-evident builds (signed provenance), CI-based builds.</li><li>SLSA 3: non-falsifiable provenance (builds in trusted, isolated environments) and stronger controls.</li><li>SLSA 4: fully verifiable builds with reproducible artifacts and hardened supply chain controls.</li></ul><p>Adopting SLSA helps organizations plan incremental improvements and set measurable goals for artifact trustworthiness.</p><h2 id="7-package-ecosystem-hazards-and-mitigations">7. Package ecosystem hazards and mitigations</h2><p>Different ecosystems have different risks:</p><ul><li>npm: high churn, easy publishing, and historical issues with malicious packages and typosquatting.</li><li>PyPI: similar to npm, with some cases of dependency confusion and malicious wheels.</li><li>Crates.io: centralization and build artifacts risks, though Rust&rsquo;s crate ecosystem often compiles from source.</li></ul><p>Mitigations:</p><ul><li>Use lockfiles with strict checksums (<code>package-lock.json</code>, <code>Pipfile.lock</code>, <code>poetry.lock</code>, <code>Cargo.lock</code>).</li><li>Use dependency scanning and SBOM integration to detect known vulnerabilities.</li><li>Consider private registries for production-critical dependencies and vetting of packages.</li></ul><h2 id="8-cicd-hardening-and-build-environment-isolation">8. CI/CD hardening and build environment isolation</h2><p>CI systems are prime targets: compromised CI credentials or runners allow attackers to alter artifacts. Key practices:</p><ul><li>Least privilege: grant CI jobs only the permissions they require, and use short-lived tokens.</li><li>Isolated runners: prefer ephemeral, single-use runners for untrusted jobs and use separate runners for critical signing steps.</li><li>Review gates: require mandatory code review approvals for changes to build scripts, signing configs, or deployment manifests.</li></ul><h3 id="81-secrets-and-key-management">8.1 Secrets and key management</h3><ul><li>Use a secrets manager (vault, cloud KMS) with auditable access policies.</li><li>Avoid storing long-lived private keys on runners; use HSM/KMS-based signing where possible or rely on Sigstore&rsquo;s ephemeral certs.</li></ul><h2 id="9-attestation-policies-and-enforcement">9. Attestation policies and enforcement</h2><p>Attestations are only useful when enforced: policy engines should verify provenance and SBOMs before permitting artifact promotion.</p><ul><li>Implement admission controllers (e.g., Kubernetes OPA/Gatekeeper) that check image provenance and required signatures before allowing deployments.</li><li>Use CI gates to reject builds missing SBOMs or required attestations (e.g., test coverage attestation, vulnerability scan attestation).</li></ul><h2 id="10-secure-updates-and-rollback-strategies">10. Secure updates and rollback strategies</h2><p>Software updates are an attack vector; ensure update mechanisms are authenticated and have safe rollback strategies:</p><ul><li>Signed updates and validation: clients must validate signatures and provenance before applying updates.</li><li>Use monotonic versioning and metadata checks to prevent rollbacks to compromised older releases unless explicitly authorized.</li><li>For critical infrastructure, staged rollouts and progressive canarying reduce blast radius.</li></ul><h2 id="11-case-study-solarwinds-and-what-changed">11. Case study: SolarWinds and what changed</h2><p>The SolarWinds incident demonstrated a sophisticated compromise of the build and signing pipeline, leading to widely distributed malicious updates. Key takeaways:</p><ul><li>The need for strong CI isolation and verification of build outputs.</li><li>Value of external audits and cross-validation where possible.</li><li>Importance of reproducible builds and independent reconstruction of releases to detect tampering.</li></ul><h2 id="12-operational-runbook-compromise-detection-and-response">12. Operational runbook: compromise detection and response</h2><p>Detection signals:</p><ul><li>Unexpected provenance: release artifacts signed by unknown keys or produced by unknown build jobs.</li><li>Anomalous package metadata changes or newly introduced transitive dependencies.</li><li>Alerts from CT/SBOM monitoring or external vulnerability feeds.</li></ul><p>Immediate response steps:</p><ol><li>Stop distribution/publishing of the artifact and isolate registries.</li><li>Revoke any compromised signing credentials and rotate keys.</li><li>Snapshot affected artifacts and build environments for forensic analysis.</li><li>Rebuild artifacts from source in isolated environment and compare checksums.</li><li>Notify downstream consumers and coordinate a fix/rollback.</li></ol><h2 id="13-tooling-landscape-what-to-adopt-today">13. Tooling landscape: what to adopt today</h2><ul><li>SBOM generation: Syft, CycloneDX tooling, SPDX generators.</li><li>Signing and transparency: Sigstore (Fulcio, Rekor, Cosign), Notation integration.</li><li>Provenance & attestation: in-toto, SLSA checkers, Grafeas/Artifact Registry with provenance support.</li><li>Vulnerability scanning and policy enforcement: Trivy, Grype, OPA/Gatekeeper.</li></ul><h2 id="14-developer-experience-making-supply-chain-security-usable">14. Developer experience: making supply chain security usable</h2><p>Security measures must be usable to get adoption:</p><ul><li>Automate SBOM and attestation generation in CI with minimal developer intervention.</li><li>Provide clear, actionable failure messages when policies reject a build.</li><li>Offer developer-friendly signing paths (Sigstore OIDC flow) instead of complex key management by individuals.</li></ul><h2 id="15-reproducibility-in-container-images">15. Reproducibility in container images</h2><p>Container images should be built from pinned base images and producing deterministic manifests where possible. Approaches:</p><ul><li>Use content-addressable image digests, not tags, in production manifests.</li><li>Record and sign the exact manifest and associated SBOM/provenance.</li><li>Rebuild images in isolated environments to verify digest equality.</li></ul><h2 id="16-attesting-source-control-and-ci-dependency-chains">16. Attesting source control and CI dependency chains</h2><ul><li>Record commit SHAs and the CI job invocation parameters as part of provenance.</li><li>Record builder environment versions and toolchain hashes (compiler versions, package manager versions).</li></ul><h2 id="17-supply-chain-for-third-party-binaries-and-firmware">17. Supply chain for third-party binaries and firmware</h2><p>Third-party binary dependencies and firmware add complexity:</p><ul><li>Demand SBOMs and checksums from vendors; require signed releases and provenance.</li><li>For firmware, preserve secure boot chains and require signed firmware updates with verifiable attestations.</li></ul><h2 id="18-governance-and-compliance-policies-and-audits">18. Governance and compliance: policies and audits</h2><p>Establish policies that define acceptable risk and artifact assurance levels. Policies should include:</p><ul><li>Required SBOM quality level and fields.</li><li>Required attestations for production artifacts (e.g., test results, static analysis, vulnerability scan status).</li><li>Audit schedules and third-party audits for critical components.</li></ul><h2 id="19-measuring-supply-chain-security-maturity">19. Measuring supply chain security maturity</h2><p>Track metrics:</p><ul><li>Percentage of production artifacts with SBOMs attached.</li><li>Percent of builds with signed provenance and required attestations.</li><li>Time to detect and remediate compromised dependencies.</li></ul><p>These metrics help plan SLSA level improvements and allocate resources.</p><h2 id="21-in-toto-example-and-layout-practical-snippet">21. in-toto example and layout (practical snippet)</h2><p>in-toto provides a way to record steps in a supply chain and sign their output links. Below is a minimal example of an in-toto <code>layout</code> that requires a build step and a test step, both producing link metadata that is later verified.</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-json" data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;_type&#34;</span>: <span style=color:#a5d6ff>&#34;layout&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;keys&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;builder&#34;</span>: { <span style=color:#7ee787>&#34;keyid&#34;</span>: <span style=color:#a5d6ff>&#34;abcd1234&#34;</span>, <span style=color:#7ee787>&#34;keytype&#34;</span>: <span style=color:#a5d6ff>&#34;rsa&#34;</span>, <span style=color:#7ee787>&#34;keyval&#34;</span>: { <span style=color:#7ee787>&#34;public&#34;</span>: <span style=color:#a5d6ff>&#34;...&#34;</span> } }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;steps&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;name&#34;</span>: <span style=color:#a5d6ff>&#34;build&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;expected_materials&#34;</span>: [],
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;expected_products&#34;</span>: [[<span style=color:#a5d6ff>&#34;CREATE&#34;</span>, <span style=color:#a5d6ff>&#34;artifact.tar.gz&#34;</span>]],
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;pubkeys&#34;</span>: [<span style=color:#a5d6ff>&#34;builder&#34;</span>],
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;expected_command&#34;</span>: [[<span style=color:#a5d6ff>&#34;/bin/sh&#34;</span>, <span style=color:#a5d6ff>&#34;build.sh&#34;</span>]]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;name&#34;</span>: <span style=color:#a5d6ff>&#34;test&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;expected_materials&#34;</span>: [[<span style=color:#a5d6ff>&#34;MATCH&#34;</span>, <span style=color:#a5d6ff>&#34;artifact.tar.gz&#34;</span>, <span style=color:#a5d6ff>&#34;FROM&#34;</span>, <span style=color:#a5d6ff>&#34;build&#34;</span>]],
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;expected_products&#34;</span>: [[<span style=color:#a5d6ff>&#34;CREATE&#34;</span>, <span style=color:#a5d6ff>&#34;artifact-tested.tar.gz&#34;</span>]],
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;pubkeys&#34;</span>: [<span style=color:#a5d6ff>&#34;builder&#34;</span>],
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;expected_command&#34;</span>: [[<span style=color:#a5d6ff>&#34;/bin/sh&#34;</span>, <span style=color:#a5d6ff>&#34;test.sh&#34;</span>]]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;inspect&#34;</span>: []
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>A verification process runs <code>in-toto verify</code> with the layout and collected links (signed metadata from each step). This ensures the build followed the recorded steps and that artifacts are traceable.</p><h2 id="22-ci-signing-workflow-example-github-actions">22. CI signing workflow example (GitHub Actions)</h2><p>Below is a concise GitHub Actions job that builds, generates an SBOM (using Syft), signs the image with Cosign using OIDC, and uploads an attestation to Rekor. This pattern avoids storing long-lived private keys on runners.</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-yaml" data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>build-and-sign</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#7ee787>on</span>:<span style=color:#6e7681> </span>[<span style=color:#a5d6ff>push]</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#7ee787>jobs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>build</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>runs-on</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ubuntu-latest</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>permissions</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>contents</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>read</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>id-token</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>write</span><span style=color:#6e7681> </span><span style=color:#8b949e;font-style:italic># required for OIDC</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>steps</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>uses</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>actions/checkout@v4</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Build image</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>run</span>:<span style=color:#6e7681> </span>|<span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          docker build -t ghcr.io/${{ github.repository }}:${{ github.sha }} .</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Generate SBOM</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>run</span>:<span style=color:#6e7681> </span>|<span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          syft -o cyclonedx-json --file=sbom.json ghcr.io/${{ github.repository }}:${{ github.sha }}</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Sign image with Cosign (OIDC)</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>run</span>:<span style=color:#6e7681> </span>|<span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          cosign sign --oidc ghcr.io/${{ github.repository }}:${{ github.sha }}</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Upload provenance</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>run</span>:<span style=color:#6e7681> </span>|<span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          cosign attest --predicate sbom.json --type cyclonedx ghcr.io/${{ github.repository }}:${{ github.sha }}</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>This job uses the OIDC flow and leaves no long-lived signing keys on the runner.</p><h2 id="23-nix-guix-and-reproducible-builds-practical-strategies">23. Nix, Guix and reproducible builds: practical strategies</h2><p>Declarative build systems such as Nix and Guix give strong reproducibility guarantees by pinning exact package versions and build inputs in a reproducible graph. Practical tips:</p><ul><li>Use fixed-output derivations for binary outputs to ensure inputs produce expected digests.</li><li>Employ <code>SOURCE_DATE_EPOCH</code> and other deterministic environment variables to remove time variance.</li><li>Pin external resources and mirror artifacts in trusted registries.</li></ul><p>For traditional build systems, containerizing the builder or using ephemeral, versioned builder VMs reduces environmental drift.</p><h2 id="24-tuf-and-notary-for-secure-update-frameworks">24. TUF and Notary for secure update frameworks</h2><p>The Update Framework (TUF) provides a specification and metadata format for secure update distribution with delegations, threshold signing and key rotation. Notary v2 integrates TUF-like protections for container images and supports multiple trust roots.</p><p>Key benefits of TUF:</p><ul><li>Compromise resilience via role separation (root, snapshot, timestamp, targets)</li><li>Rolling key rotation and delegated responsibilities</li><li>Fine-grained control over which targets (artifacts) are signed by which keys</li></ul><h2 id="25-notable-incidents-and-lessons-learned">25. Notable incidents and lessons learned</h2><ul><li><p>Event-Stream npm compromise (2018): an attacker took over an unmaintained package and added malicious code to a patched version. Lesson: maintainers and consumers should track package stewardship and use verification and review for critical dependencies.</p></li><li><p>PyPI typosquatting / dependency confusion: publishing similar-sounding packages or registering names to trick users into installing malicious code. Lesson: Use scoped packages when possible and vet new transitive dependencies.</p></li><li><p>SolarWinds: demonstrated the danger of signing compromised artifacts and the need for provenance and reproducible builds.</p></li></ul><h2 id="26-attack-trees-and-mitigations">26. Attack trees and mitigations</h2><p>Common supply-chain attack vectors:</p><ul><li>Compromised developer accounts (social engineering or credential theft).</li><li>Malicious code in upstream dependencies.</li><li>CI pipeline compromise (runner compromise or leaked secrets).</li><li>Registry compromise (publishing malicious packages or replacing artifacts).</li></ul><p>Mitigations map to each vector: MFA and phishing-resistant auth for developers, code review and dependency scanning, isolated CI runners and short-lived credentials, registry immutability and signed artifacts.</p><h2 id="27-incident-response-playbook-detailed">27. Incident response playbook (detailed)</h2><ol><li>Triage: identify affected artifacts and scope (via SBOMs and provenance).</li><li>Quarantine: disable distribution channels and deny new releases until verification.</li><li>Revoke & rotate: revoke signing keys and rotate credentials used by CI.</li><li>Rebuild & verify: re-run builds in an isolated environment and compare checksums to suspect artifacts.</li><li>Remediate: issue signed patches and coordinate with downstream users, including posting advisories and recommended rollback/patch actions.</li><li>Post-incident: run a retrospective, close security gaps (e.g., fix CI isolation, enable SLSA improvements), and update monitoring.</li></ol><h2 id="28-developer--operator-checklist-actionable">28. Developer & operator checklist (actionable)</h2><ul><li>Add SBOM generation to CI and attach SBOMs to artifacts.</li><li>Require signed provenance for production artifacts and verify attestations at promotion time.</li><li>Use OIDC-based signing or HSM-backed keys for signing steps.</li><li>Enforce dependency lockfiles and use vulnerability scanners with automated alerts.</li><li>Harden CI: ephemeral runners, least privilege, and auditable logs.</li><li>Pilot reproducible builds: target a small subset of critical artifacts first.</li></ul><h2 id="29-faq-short">29. FAQ (short)</h2><p>Q: Are SBOMs enough to prevent supply chain attacks?</p><p>A: No — SBOMs increase visibility but must be combined with attestations, signing, and runtime controls to be effective.</p><p>Q: Can we fully automate remediation for vulnerable dependencies?</p><p>A: Automation helps (e.g., PRs to update dependencies), but human review for high-impact changes is still essential.</p><h2 id="30-practical-verification--cli-recipes">30. Practical verification & CLI recipes</h2><p>Verify a cosign signature and that it&rsquo;s recorded in Rekor:</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-sh" data-lang=sh><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Verify the signature and certificate chain</span>
</span></span><span style=display:flex><span>cosign verify --key cosign.pub ghcr.io/org/image:sha256:abc123
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Verify that Rekor has a record of the signature (using cosign&#39;s Rekor integration)</span>
</span></span><span style=display:flex><span>cosign verify --rekor-url https://rekor.example.com ghcr.io/org/image:sha256:abc123
</span></span></code></pre></div><p>Quick SBOM checks (CycloneDX JSON + jq):</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-sh" data-lang=sh><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Count unique packages in the SBOM</span>
</span></span><span style=display:flex><span>jq <span style=color:#a5d6ff>&#39;.components | length&#39;</span> sbom.json
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Check for a specific package and version</span>
</span></span><span style=display:flex><span>jq <span style=color:#a5d6ff>&#39;.components[] | select(.name==&#34;openssl&#34; and .version==&#34;1.1.1k&#34;)&#39;</span> sbom.json
</span></span></code></pre></div><p>Rebuild and verify pipeline snippet (simplified):</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-sh" data-lang=sh><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Rebuild in isolated environment and compare digests</span>
</span></span><span style=display:flex><span>docker build -t rebuilt:local .
</span></span><span style=display:flex><span>docker inspect --format<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#39;{{index .RepoDigests 0}}&#39;</span> rebuilt:local
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># compare with published digest</span>
</span></span></code></pre></div><h2 id="31-policy-as-code-example-opagatekeeper">31. Policy-as-code example (OPA/Gatekeeper)</h2><p>A minimal Rego rule that rejects Kubernetes Pod specs that reference container images without a matching signed attestation (pseudocode):</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-rego" data-lang=rego><span style=display:flex><span><span style=color:#ff7b72>package</span><span style=color:#6e7681> </span>kubernetes<span style=color:#ff7b72;font-weight:700>.</span>admission<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span>deny[msg]<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>input<span style=color:#ff7b72;font-weight:700>.</span>request<span style=color:#ff7b72;font-weight:700>.</span>kind<span style=color:#ff7b72;font-weight:700>.</span>kind<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Pod&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>image<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>:=</span><span style=color:#6e7681> </span>input<span style=color:#ff7b72;font-weight:700>.</span>request<span style=color:#ff7b72;font-weight:700>.</span>object<span style=color:#ff7b72;font-weight:700>.</span>spec<span style=color:#ff7b72;font-weight:700>.</span>containers[_]<span style=color:#ff7b72;font-weight:700>.</span>image<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#ff7b72>not</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>image_has_provenance</span>(image)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>msg<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>sprintf</span>(<span style=color:#a5d6ff>&#34;image %s missing signed provenance&#34;</span><span style=color:#ff7b72;font-weight:700>,</span><span style=color:#6e7681> </span>[image])<span style=color:#6e7681>
</span></span></span><span style=display:flex><span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span>image_has_provenance(image)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># Implementation: query an attestation index (by tag/digest)</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># and validate Rekor / Cosign presence. This example omits network</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># calls for brevity.</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#79c0ff>true</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><p>In practice, integrate this with an admission controller that can query your attestation store or Rekor mirror.</p><h2 id="32-tuf-metadata-snippet-targets-example">32. TUF metadata snippet (targets example)</h2><p>TUF&rsquo;s <code>targets.json</code> lists signed metadata about artifacts. A simplified example:</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-json" data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;_type&#34;</span>: <span style=color:#a5d6ff>&#34;targets&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;spec_version&#34;</span>: <span style=color:#a5d6ff>&#34;1.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;targets&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;myapp-1.2.3.tar.gz&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;hashes&#34;</span>: { <span style=color:#7ee787>&#34;sha256&#34;</span>: <span style=color:#a5d6ff>&#34;...&#34;</span> },
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;length&#34;</span>: <span style=color:#a5d6ff>123456</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>TUF clients confirm the signed <code>timestamp.json</code> and <code>snapshot.json</code> to ensure they fetch up-to-date, signed targets and to prevent rollback attacks.</p><h2 id="33-90day-rollout-roadmap-practical">33. 90‑day rollout roadmap (practical)</h2><p>Week 1–2: Inventory & quick wins</p><ul><li>Generate SBOMs for critical services and store them with artifacts.</li><li>Add daily vulnerability scans and alerts for critical findings.</li></ul><p>Weeks 3–6: Enforce signing and provenance</p><ul><li>Add Cosign signing to CI using OIDC for images; attach SBOMs and attestations.</li><li>Start Rekor mirror or use public Rekor with monitoring alerts.</li></ul><p>Weeks 7–10: Policies & enforcement</p><ul><li>Deploy admission controllers (OPA/Gatekeeper) in staging to block unsigned images.</li><li>Pilot reproducible builds for one critical service and verify digests.</li></ul><p>Weeks 11–12: Harden & audit</p><ul><li>Rotate keys and move signing to KMS/HSM if needed.</li><li>Conduct a focused audit or red-team around the CI pipeline.</li></ul><h2 id="34-additional-case-study-detail-small-org-attack-vector">34. Additional case study detail: small org attack vector</h2><p>A small org relying on community packages and a single CI runner was compromised when a maintainer&rsquo;s account was phished. The attacker published a patched release with a build script that exfiltrated secrets at runtime. Mitigations that would have reduced impact:</p><ul><li>Enforce code review for changes to build scripts.</li><li>Use ephemeral runners and restrict network access to build-time artifacts.</li><li>Require signed attestation for production artifacts and detect unexpected provenance origins.</li></ul><h2 id="35-final-checklist-governing-sprint-tasks">35. Final checklist (governing sprint tasks)</h2><ul><li>SBOMs in CI for all builds ✅</li><li>Cosign signing (OIDC) and Rekor logging ✅</li><li>Admission controller in staging verifying attestations ✅</li><li>Rebuilds proving digest reproducibility (pilot) ✅</li><li>Incident response playbook and monitoring alerts ✅</li></ul><h2 id="36-closing-and-further-reading">36. Closing and further reading</h2><p>Defending the supply chain is an iterative, cross-functional effort involving developers, build engineers, security, and operations. Start with visibility (SBOMs) and signing (Sigstore), then add reproducibility and policy enforcement. Consider SLSA as a roadmap and measure progress with actionable metrics.</p><p>Further reading:</p><ul><li>SLSA: <code>https://slsa.dev/</code></li><li>Sigstore: <code>https://sigstore.dev/</code></li><li>in-toto: <code>https://in-toto.io/</code></li><li>CycloneDX/SPDX documentation</li><li>Reproducible Builds project and Debian reproducibility efforts</li></ul><h2 id="appendix-a-sbom-diff--verification-example">Appendix A: SBOM diff & verification example</h2><p>A small script to diff two CycloneDX SBOMs by package name and version (using <code>jq</code>):</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-sh" data-lang=sh><span style=display:flex><span>jq -r <span style=color:#a5d6ff>&#39;.components[] | &#34;\(.name)@\(.version)&#34;&#39;</span> sbom-old.json | sort &gt; old.txt
</span></span><span style=display:flex><span>jq -r <span style=color:#a5d6ff>&#39;.components[] | &#34;\(.name)@\(.version)&#34;&#39;</span> sbom-new.json | sort &gt; new.txt
</span></span><span style=display:flex><span>diff -u old.txt new.txt
</span></span></code></pre></div><p>This highlights package upgrades, additions, and removals between builds.</p><h2 id="appendix-b-registry-policies--lifecycle">Appendix B: Registry policies & lifecycle</h2><ul><li>Enforce immutability for release tags and prefer digests in deployment manifests.</li><li>Retain provenance and SBOM artifacts for a retention window aligned with compliance needs (e.g., 1 year minimal for many regulated environments).</li><li>Audit registry write permissions and require signed artifacts for production namespaces.</li></ul><h2 id="appendix-c-grypetrivy-ci-snippet">Appendix C: grype/trivy CI snippet</h2><p>Example of running a quick vulnerability scan in CI and failing the job on high-severity findings:</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-yaml" data-lang=yaml><span style=display:flex><span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Scan image for vulnerabilities</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>run</span>:<span style=color:#6e7681> </span>|<span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    grype ghcr.io/${{ github.repository }}:${{ github.sha }} -o json &gt; grype.json
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    if jq &#39;.matches[] | select(.vulnerability.severity==&#34;CRITICAL&#34;)&#39; grype.json | grep -q .; then
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      echo &#34;Critical vulnerabilities found&#34;; exit 1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    fi</span><span style=color:#6e7681>
</span></span></span></code></pre></div><h2 id="appendix-d-attestation-lifecycle--retention">Appendix D: Attestation lifecycle & retention</h2><p>Retention policy recommendations:</p><ul><li>Keep signed attestations and SBOMs for at least 1 year; longer if regulatory obligations require it.</li><li>Archive attestations in an immutable store (WORM) and mirror Rekor logs to internal read-only archives for forensic purposes.</li></ul><h2 id="appendix-e-tools-comparison">Appendix E: Tools comparison</h2><table><thead><tr><th>Category</th><th>Example tools</th><th>Notes</th></tr></thead><tbody><tr><td>SBOM generation</td><td>Syft, CycloneDX CLI, SPDX tools</td><td>Choose format based on downstream tooling compatibility</td></tr><tr><td>Signing & transparency</td><td>Cosign, Rekor, Fulcio</td><td>OIDC-based flows reduce key management burden</td></tr><tr><td>Provenance & attestations</td><td>in-toto, SLSA checkers, Grafeas</td><td>Use in CI to generate verifiable metadata</td></tr><tr><td>Vulnerability scanners</td><td>Grype, Trivy</td><td>Integrate into CI and policy gates</td></tr></tbody></table><hr><h2 id="appendix-f-90day-rollout-roadmap-detailed">Appendix F: 90‑day rollout roadmap (detailed)</h2><p>Week 1–2: Inventory & quick wins</p><ul><li>Generate SBOMs for critical services and store them with artifacts.</li><li>Add daily vulnerability scans and alerts for critical findings.</li></ul><p>Weeks 3–6: Enforce signing and provenance</p><ul><li>Add Cosign signing to CI using OIDC for images; attach SBOMs and attestations.</li><li>Start Rekor mirror or use public Rekor with monitoring alerts.</li></ul><p>Weeks 7–10: Policies & enforcement</p><ul><li>Deploy admission controllers (OPA/Gatekeeper) in staging to block unsigned images.</li><li>Pilot reproducible builds for one critical service and verify digests.</li></ul><p>Weeks 11–12: Harden & audit</p><ul><li>Rotate keys and move signing to KMS/HSM if needed.</li><li>Conduct a focused audit or red-team around the CI pipeline.</li></ul><hr><h2 id="37-rekor-and-transparency-log-queries-practical">37. Rekor and transparency log queries (practical)</h2><p>Rekor exposes a searchable transparency log that you can query to find signatures and certificates related to an artifact. Using <code>rekor-cli</code> or the Rekor API you can search by artifact hash or by the entry details.</p><p>Example (rekor-cli):</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-sh" data-lang=sh><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Search Rekor for entries by artifact hash</span>
</span></span><span style=display:flex><span>rekor-cli search --artifact-sha sha256:abcdef1234567890
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Fetch an entry by UUID</span>
</span></span><span style=display:flex><span>rekor-cli get --log-index <span style=color:#a5d6ff>1234</span>
</span></span></code></pre></div><p>This allows teams to write monitoring that alerts if a signature appears from an unexpected principal or if a new signature for a production image is logged unexpectedly.</p><h2 id="38-cosign-attestations--predicate-formats">38. Cosign attestations & predicate formats</h2><p>Cosign supports attesting arbitrary JSON predicates (e.g., SBOMs, test reports) using the <code>cosign attest</code> command. Predicates can be standard types (e.g., SLSA predicate) or custom JSON blobs that your policy can validate.</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-sh" data-lang=sh><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Attest with a custom predicate file</span>
</span></span><span style=display:flex><span>cosign attest --predicate predicate.json ghcr.io/org/image:sha256:abc123
</span></span></code></pre></div><p>A verifier checks the predicate contents, signature presence in Rekor, and that the predicate meets policy constraints (e.g., contains an approval field or passes a vulnerability gate).</p><h2 id="39-in-toto-link-example">39. in-toto link example</h2><p>A link file is a signed JSON blob describing inputs and outputs of a step. Example (simplified):</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-json" data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;name&#34;</span>: <span style=color:#a5d6ff>&#34;build&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;materials&#34;</span>: [<span style=color:#a5d6ff>&#34;git+https://github.com/org/repo@refs/heads/main&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;products&#34;</span>: [<span style=color:#a5d6ff>&#34;artifact.tar.gz&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;byproducts&#34;</span>: { <span style=color:#7ee787>&#34;exit-code&#34;</span>: <span style=color:#a5d6ff>0</span> }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>These links are signed by the runner and can be aggregated and verified against a layout to confirm the end-to-end process.</p><h2 id="40-language-specific-sbom-extraction-notes">40. Language-specific SBOM extraction notes</h2><ul><li>Java (Maven/Gradle): use CycloneDX plugin or <code>mvn dependency:tree</code> with CycloneDX generator to capture jar coordinates and transitive deps.</li><li>Go: <code>syft</code> can inspect Go module metadata and built binaries; prefer <code>go.sum</code> for checksums.</li><li>.NET: use NuGet export tooling and CycloneDX plugins to capture package references.</li></ul><p>Always prefer generator tools that integrate with the package manager to ensure accurate transitive dependency resolution.</p><h2 id="41-firmware--hardware-supply-chain-considerations">41. Firmware & hardware supply chain considerations</h2><p>Firmware and hardware add boot-time risks. Important practices:</p><ul><li>Require signed firmware images and validate signatures using secure boot mechanisms (UEFI Secure Boot, TPM-based attestation).</li><li>Maintain firmware SBOMs and track vendor-supplied binary blobs and their provenance.</li><li>Use measured boot and remote attestation to detect compromised boot chains in critical systems.</li></ul><h2 id="42-slsa-mapping-to-internal-policy-example">42. SLSA mapping to internal policy (example)</h2><p>Map SLSA levels to concrete organizational controls:</p><ul><li>SLSA 2 target: CI-signed builds, signed provenance, and automated generation of SBOMs.</li><li>SLSA 3 target: enforce builder isolation, tamper-evident logs for signing, and mandatory attestation verification in staging.</li><li>SLSA 4 target: reproducible builds, HSM-backed signing, third-party attestation, and rigorous hardening of build infrastructure.</li></ul><p>Consider a phased plan where each milestone corresponds to audit-able checks in your CI/CD pipeline.</p><h2 id="43-open-source-maintainer-checklist-practical">43. Open-source maintainer checklist (practical)</h2><ul><li>Enable MFA and phishing-resistant auth on maintainers&rsquo; accounts.</li><li>Use CI badges that show whether a release build had a signed attestation.</li><li>Rotate and limit access to release signing keys; prefer delegated signing services.</li><li>Provide a clear process for contributors to validate their changes and for security reporting.</li><li>Use automated SBOM generation on PRs to ensure new transitive dependencies are visible early.</li><li>Add <code>CODEOWNERS</code> or protected branches for changes to build scripts and release tooling.</li></ul><h2 id="44-common-pitfalls-and-how-to-avoid-them">44. Common pitfalls and how to avoid them</h2><ul><li>Treating SBOMs as a checkbox: ensure they are accurate and used in automations.</li><li>Relying solely on vulnerability scanners without context: triage vulnerabilities with runtime and exploitability data.</li><li>Ignoring provenance: knowing where an artifact came from is as important as knowing what&rsquo;s in it.</li><li>Over-reliance on a single signer or key: prefer KMS/HSM-backed signing or short-lived certs where possible.</li></ul><h2 id="45-developer-quickstart-cosign--syft-in-github-actions-step-by-step">45. Developer quickstart: Cosign + Syft in GitHub Actions (step-by-step)</h2><ol><li>Enable OIDC for your GitHub organization (Actions > Settings > OIDC).</li><li>Add a job to build, generate SBOM, and sign with Cosign:</li></ol><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-yaml" data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>name: Quickstart</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>build, sbom, sign</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#7ee787>on</span>:<span style=color:#6e7681> </span>[<span style=color:#a5d6ff>push]</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#7ee787>jobs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>quickstart</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>runs-on</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ubuntu-latest</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>permissions</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>id-token</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>write</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>contents</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>read</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>steps</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>uses</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>actions/checkout@v4</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Build image</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>run</span>:<span style=color:#6e7681> </span>|<span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          docker build -t ghcr.io/${{ github.repository }}:${{ github.sha }} .</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Generate SBOM (Syft)</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>run</span>:<span style=color:#6e7681> </span>|<span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          syft -o cyclonedx-json ghcr.io/${{ github.repository }}:${{ github.sha }} &gt; sbom.json</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Sign image (cosign)</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>run</span>:<span style=color:#6e7681> </span>|<span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>          cosign sign --oidc ghcr.io/${{ github.repository }}:${{ github.sha }}</span><span style=color:#6e7681>
</span></span></span></code></pre></div><ol><li>Verify in a separate job or stage that the attestation exists in Rekor and that the SBOM matches expectations.</li></ol><h2 id="46-testing--ci-checklist">46. Testing & CI checklist</h2><ul><li>Ensure SBOM generation runs on PRs and is checked into logs for review.</li><li>Add a nightly job that attempts to rebuild a checkpointed release to test reproducibility.</li><li>Run grype/trivy on images and fail on CRITICAL-only policies in CI.</li><li>Audit and log all signing events; alert on unexpected signers.</li></ul><hr><p>In closing: defend the software supply chain by combining visibility (SBOMs), attestations, and enforced policies; iterate from easy wins to stronger guarantees like reproducibility and SLSA maturity.</p><h2 id="45-solarwinds-deeper-timeline-and-mitigations">45. SolarWinds: deeper timeline and mitigations</h2><p>Timeline highlights and additional mitigation analysis:</p><ul><li>Initial compromise: attacker inserted malicious code into the build system and backdoored the Orion product.</li><li>Distribution: signed updates were released through the normal update channels, making them appear legitimate to downstream customers.</li><li>Detection: monitoring and external reporting led to discovery; patching and revocation followed.</li></ul><p>Additional mitigations to consider beyond the obvious:</p><ul><li>Build reproducibility checks for critical releases to enable independent verification that published binaries match source.</li><li>Enforce multi-person review and splitting the signing process across roles (separation of duties) to reduce single-point compromise risk.</li><li>Implementing strong runtime detection on endpoints (behavioral indicators) to detect anomalous behavior despite signed updates.</li></ul><h2 id="46-cosign--kmshsm-example-aws-kms">46. Cosign + KMS/HSM example (AWS KMS)</h2><p>Using KMS simplifies key management and allows signatures to be produced without extracting private key material to runners:</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-sh" data-lang=sh><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Configure cosign to use an AWS KMS key</span>
</span></span><span style=display:flex><span>export <span style=color:#79c0ff>COSIGN_KMS_KEY</span><span style=color:#ff7b72;font-weight:700>=</span>aws-kms://arn:aws:kms:us-east-1:123456789:key/abcd-efgh
</span></span><span style=display:flex><span>cosign sign --kms <span style=color:#79c0ff>$COSIGN_KMS_KEY</span> ghcr.io/org/image:sha256:abc123
</span></span></code></pre></div><p>This stores signing material in KMS and allows centralized rotation and IAM-based access control.</p><h2 id="47-oparego-sample-for-sbom-based-policy">47. OPA/rego sample for SBOM-based policy</h2><p>A simple policy to reject images where the SBOM indicates a CRITICAL vulnerability (using a precomputed vulnerability list in the admission controller):</p><div class="highlight"><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class="language-rego" data-lang=rego><span style=display:flex><span><span style=color:#ff7b72>package</span><span style=color:#6e7681> </span>kubernetes<span style=color:#ff7b72;font-weight:700>.</span>admission<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span>deny[msg]<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>input<span style=color:#ff7b72;font-weight:700>.</span>request<span style=color:#ff7b72;font-weight:700>.</span>kind<span style=color:#ff7b72;font-weight:700>.</span>kind<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Pod&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#ff7b72>some</span><span style=color:#6e7681> </span>i<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>image<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>:=</span><span style=color:#6e7681> </span>input<span style=color:#ff7b72;font-weight:700>.</span>request<span style=color:#ff7b72;font-weight:700>.</span>object<span style=color:#ff7b72;font-weight:700>.</span>spec<span style=color:#ff7b72;font-weight:700>.</span>containers[i]<span style=color:#ff7b72;font-weight:700>.</span>image<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>vulnerabilities<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>:=</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>get_vulns_for_image</span>(image)<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>vulnerabilities[_]<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;CRITICAL&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>msg<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>sprintf</span>(<span style=color:#a5d6ff>&#34;image %s has critical vulnerabilities&#34;</span><span style=color:#ff7b72;font-weight:700>,</span><span style=color:#6e7681> </span>[image])<span style=color:#6e7681>
</span></span></span><span style=display:flex><span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><p>The <code>get_vulns_for_image</code> function would query a vulnerability index populated by CI scans or an external scanning service.</p><h2 id="48-incident-notification-template">48. Incident notification template</h2><p>Subject: [SECURITY] Supply Chain Incident: [artifact] - [short summary]</p><p>Body:</p><ul><li>Summary of the incident and affected artifacts</li><li>Time window and scope of distribution</li><li>Immediate recommendations (e.g., stop pulling image X, roll back to Y)</li><li>Actions taken (revoked keys, isolated registry)</li><li>Contact points and follow-up plan</li></ul><h2 id="49-glossary-short">49. Glossary (short)</h2><ul><li>SBOM: Software Bill of Materials — a list of components and dependencies that make up an artifact.</li><li>Attestation: a signed statement describing properties of an artifact (e.g., built-by, tests-passed).</li><li>Rekor: Sigstore&rsquo;s transparency log for signatures and attestations.</li><li>SLSA: Supply chain Levels for Software Artifacts — a maturity framework.</li></ul><hr><p>How to get started in one hour:</p><ul><li>Generate an SBOM for a single critical service (<code>syft</code> or CycloneDX plugin) and store it as an artifact in CI.</li><li>Add a GitHub Actions step to sign images with <code>cosign --oidc</code> and verify the Rekor entry appears.</li><li>Run a quick vulnerability scan (<code>grype</code>) and set an alert for any CRITICAL findings.</li></ul><p>Call to action: pick one service and roll out the three steps above in a single sprint; measure results and iterate toward broader coverage.</p><p>In closing: defend the software supply chain by combining visibility (SBOMs), attestations, and enforced policies; iterate from easy wins to stronger guarantees like reproducibility and SLSA maturity. Measure and report progress monthly to maintain momentum. If you&rsquo;d like, I can help audit one repository and implement the quickstart in a sprint.</p></div><footer class="ce1a612 c6dfb1e c3ecea6"><div class="c364589">Categories:
<a href=/categories/security/>security</a>, <a href=/categories/devops/>devops</a></div><div>Tags:
<a href=/tags/supply-chain/>#supply-chain</a>, <a href=/tags/sbom/>#sbom</a>, <a href=/tags/sigstore/>#sigstore</a>, <a href=/tags/reproducible-builds/>#reproducible-builds</a>, <a href=/tags/slsa/>#slsa</a>, <a href=/tags/security/>#security</a></div></footer></article></main><footer class="ccdf0e8" role=contentinfo aria-label=Footer><div class="cfdda01 c133889 c5df473 c0eecc8 c69618a c6942b3 c03620d c2a9f27 c7c11d8 c82c52d c14527b"><div class="c6dfb1e c3ecea6 c39ef11 c88ae6f">&copy; 2026 Leonardo Benicio. All rights
reserved.</div><div class="c6942b3 c7c11d8 cd1fd22"><a href=https://github.com/lbenicio target=_blank rel="noopener noreferrer" aria-label=GitHub class="c1d6c20 c7c11d8 c1d0018 cd1fd22 cb5c327 c10dda9 c6dfb1e cbbda39 cfc01c7 c01f421 c286dd7 c2bd687 cfdce1d cfef18f c000b66 cf55a7b c514027"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8.0 00-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35.0-3.5.0.0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35.0 3.5A5.403 5.403.0 004 9c0 3.5 3 5.5 6 5.5-.39.5-.67 1.08-.82 1.7s-.2 1.27-.18 1.9V22"/></svg>
<span class="cba5854">GitHub</span>
</a><a href=https://www.linkedin.com/in/leonardo-benicio target=_blank rel="noopener noreferrer" aria-label=LinkedIn class="c1d6c20 c7c11d8 c1d0018 cd1fd22 cb5c327 c10dda9 c6dfb1e cbbda39 cfc01c7 c01f421 c286dd7 c2bd687 cfdce1d cfef18f c000b66 cf55a7b c514027"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452H17.21V14.86c0-1.333-.027-3.046-1.858-3.046-1.86.0-2.145 1.45-2.145 2.948v5.69H9.069V9h3.112v1.561h.044c.434-.82 1.494-1.686 3.074-1.686 3.29.0 3.897 2.165 3.897 4.983v6.594zM5.337 7.433a1.805 1.805.0 11-.002-3.61 1.805 1.805.0 01.002 3.61zM6.763 20.452H3.911V9h2.852v11.452z"/></svg>
<span class="cba5854">LinkedIn</span>
</a><a href=https://twitter.com/lbenicio_ target=_blank rel="noopener noreferrer" aria-label=Twitter class="c1d6c20 c7c11d8 c1d0018 cd1fd22 cb5c327 c10dda9 c6dfb1e cbbda39 cfc01c7 c01f421 c286dd7 c2bd687 cfdce1d cfef18f c000b66 cf55a7b c514027"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19.633 7.997c.013.177.013.354.013.53.0 5.386-4.099 11.599-11.6 11.599-2.31.0-4.457-.676-6.265-1.842.324.038.636.05.972.05 1.91.0 3.67-.65 5.07-1.755a4.099 4.099.0 01-3.827-2.84c.25.039.5.064.763.064.363.0.726-.051 1.065-.139A4.091 4.091.0 012.542 9.649v-.051c.538.3 1.162.482 1.824.507A4.082 4.082.0 012.54 6.7c0-.751.2-1.435.551-2.034a11.63 11.63.0 008.44 4.281 4.615 4.615.0 01-.101-.938 4.091 4.091.0 017.078-2.799 8.1 8.1.0 002.595-.988 4.112 4.112.0 01-1.8 2.261 8.2 8.2.0 002.357-.638A8.824 8.824.0 0119.613 7.96z"/></svg>
<span class="cba5854">Twitter</span></a></div></div></footer></body></html>